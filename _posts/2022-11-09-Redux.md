---
title: "Redux 설명"
execrpt: "vanilla-Js, React 설명"
toc: true
toc_sticky: true
categories:
  - JS
tags:
  - JS
last_modified_at: 2022-11-09
---
# vanillaJs
vanillaJS 증감 코드  
```js
/** count를 modify(수정)하기 위한 코드 */
// 이 케이스에서는 redux가 -1이나 +1을 count하는 걸 도와주기 위해 만들어졌다.
const add = document.querySelector(`#add`);
const minus = document.querySelector(`#minus`);
const number = document.querySelector(`span`);

// data가 유일하게 바뀌는 지점
// 이 코드에서 가지고 있는 유일한 data이다. count를 increase(증가), decrease(감소)할 수 있다.
let count = 0;
number.innerText = count;

const updateText = () => {
  number.innerText = count;
}

const handleAdd = () => {
  count++;
  updateText();
}

const handleMinus = () => {
  count--;
  updateText();
}

add.addEventListener(`click`, handleAdd);
minus.addEventListener(`click`, handleMinus);
```

## { createStore } from "redux"

**import { createStore } from "redux" ;**     
- store : 나의 data를 넣는곳.(나의 state)
- state는 나의 application에서 바뀌는 data를 말한다.
- store가 하는 일은 기본적으로 data를 넣을 수 있는 장소를 생성한다. (redux가 가장 잘 하는것)
- 리덕스는 data를(관리하는데) 도와주는 역할을 하기 위해 만들어졌다.
- 그리고 그 데이터는 store라는 곳에 저장 되어야(go on)한다.

**순서**
1. 처음으로 store을 만든다. (store는 data를 저장하는 곳이다.)
2. store를 만들면 reducer를 만들어 달라고 요구한다. 
3. !!중요 `reducer는 function이다.` (data를 modify하는!)
4. 만약 reducer가 "hello"를 리턴한다면 이게 application에 있는 data가 될 것이다.
5. reducer나 modifier는 처음으로 나의 data를 바꿔준다.
6. 하지만 또 뭐든지 return하는 것은, 나의 application에 있는 data이다.

`예시`
```js
// const reducer = () => {};
// const store = createStore(reducer);

const countModifier = () => {
  return "hello";
};

const countstore = createStore(countModifier);

console.log(countstore);
 //-> dispatch, subscribe, getState, replaceReducer, Symbol 5개의 함수를 볼 수 있다.

console.log(countstore.getState()); 
// -> hello : application의 data가 된다.
```
- countModifier가 1을 리턴하면 현재 나의 application의 상태는 `1`이 된다.
- 뭐든지 modifier와 reducer이 return하는 건 나의 application의 data가 된다.
- countModifier만 유일하게 data를 modify 할 수 있다.
- 유일하게 한 개의 함수만 data를 modify할 수 있고 이게 redux의 파워이다.

## state

```js
const countModifier = (state) => {
  console.log(state); // -> undefined
  return state;
};

const countstore = createStore(countModifier);
```

```js
// state를 0의 값으로 초기화(디폴트 값을 0으로)
const countModifier = (state = 0) => {
  console.log(state); // -> 0
  return state;
};

const countstore = createStore(countModifier);
console.log(countstore.getState());
// --> 0
```

## Actions
- action은 redux에서 function을 부를떄 쓰는 두번쨰parameter, 혹은 argument이다.
- action에는 우리가 countModifier과 소통하기 위한 방법들이 있다.
- countModifier에게 action을 보낼 수 있는 방법으로 dispatch(보내다)가 있다.
- dispatch 로 보내는것은 object만 가능하다.
- `action은 type이 있어야한다.`
`예시`
```js
const countModifier = (count = 0, action) => {
  console.log(action);
  return count;
};

const countstore = createStore(countModifier);
// 보내는것은 object만 가능.
countstore.dispatch({ type: "HELLO" });
```
- 위의 예제에서 action의 값은 `{ type: "HELLO" }` 가 된다.

## subscribe
- subscribe 는 store 안에 있는 변화들을 알 수 있게 해준다.
- store에 변화가 있을 때마다 감지해서 불러진다.

`예시`
```js
const onChange = () =>{
    number.innerText = countstore.getState();
};

countstore.subscribe(onChange);
```

## createStore, dispatch, subscribe 증감 사용예제
`기본증감 예제`
```js
import { createStore } from "redux";

const add = document.querySelector(`#add`);
const minus = document.querySelector(`#minus`);
const number = document.querySelector(`span`);

number.innerText = 0;

const countModifier = (count = 0, action) => {
  switch (action.type) {
    case "ADD":
      return count + 1
    case "MINUS":
      return count - 1
    default:
      return count
};

const countstore = createStore(countModifier);

countstore.subscribe(() => number.innerText = countstore.getState());

add.addEventListener("click", () => countstore.dispatch({ type: "ADD" }));
minus.addEventListener("click", () => countstore.dispatch({ type: "MINUS" }));
```

## Vanilla ToDo

`예시`  
  

```js
const form = document.querySelector("form");
const input = document.querySelector("input");
const ul = document.querySelector("ul");

const createToDo = toDo => {
  const li = document.createElement("li");
  li.innerText = toDo;
  ul.appendChild(li);
};

const onSubmit = e => {
  e.preventDefault();
  const toDo = input.value;
  input.value = "";
  createToDo(toDo);
}

form.addEventListener("submit", onSubmit);

```

## State Mutation
- state 는 Single source of truth이고 read-only 이다.
- store를 수정할 수 있는 유일한 방법은 action을 보내는 방법뿐이다.
- state에 절대 mutate를 하지 말아야한다.
- mutating state하는 대신에 new state objects를 리턴해야 한다.
